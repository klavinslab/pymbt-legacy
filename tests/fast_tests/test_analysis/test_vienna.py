'''Tests for Vienna RNA module.'''
from nose.tools import assert_equal
from pymbt import analysis, DNA


class TestVienna(object):
    '''Tests for Vienna class.'''
    def __init__(self):
        # M13R primer sequence
        self.dna = DNA('agcggataacaatttcacacaggaaacagctatgaccatg')
        self.vienna = analysis.Vienna([self.dna])

    def test_mfe(self):
        mfe = self.vienna.mfe(temp=37.0)
        assert_equal(mfe, [-4.1])

    def test_unbound_probability(self):
        pairs = self.vienna.unbound_probability(temp=50.0)
        expected = [[0.5471488180302031, 0.3349653059771742, 0.3824397755171302, 0.4815726623297834, 0.40027940891620356, 0.4479845456559513, 0.974591814445454, 0.9799761753696706, 0.995251252853918, 0.8730397590297804, 0.9979940105165378, 0.9854520357486868, 0.9335774289167383, 0.6762105972879312, 0.3812335650791805, 0.37802369756767606, 0.9776097122401626, 0.8655935869998003, 0.9887272339046042, 0.9473873679633547, 0.9903836452969978, 0.11770706512618055, 0.9351872604013453, 0.947831625435884, 0.9530678302101463, 0.9703501437768908, 0.12761875891971447, 0.9844559132556017, 0.35868751318745257, 0.37817113478565484, 0.5281027940998698, 0.989153078805485, 0.9416961340351085, 0.9478255484897061, 0.9789315638537998, 0.9613353635406799, 0.9589465352015291, 0.9943679547248708, 0.9903593851918062, 0.9934173944741524]]
        assert_equal(pairs, expected)
